<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width initial-scale=1" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">

  <title>Laravel v5.2 框架学习笔记（一）：基础</title>
  <meta name="description" content="求知，思考，高效生活">
  <meta name="author" content="孟凡泽">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Meng Fanze">
  <meta name="twitter:description" content="求知，思考，高效生活">

  <meta property="og:type" content="article">
  <meta property="og:title" content="Meng Fanze">
  <meta property="og:description" content="求知，思考，高效生活">

  <link rel="apple-touch-icon" sizes="57x57" href="/images/favicons/apple-touch-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/images/favicons/apple-touch-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/images/favicons/apple-touch-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/images/favicons/apple-touch-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/images/favicons/apple-touch-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/images/favicons/apple-touch-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/images/favicons/apple-touch-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/images/favicons/apple-touch-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/favicons/apple-touch-icon-180x180.png">
  <link rel="icon" type="image/png" href="/images/favicons/favicon-32x32.png" sizes="32x32">
  <link rel="icon" type="image/png" href="/images/favicons/favicon-194x194.png" sizes="194x194">
  <link rel="icon" type="image/png" href="/images/favicons/favicon-96x96.png" sizes="96x96">
  <link rel="icon" type="image/png" href="/images/favicons/android-chrome-192x192.png" sizes="192x192">
  <link rel="icon" type="image/png" href="/images/favicons/favicon-16x16.png" sizes="16x16">
  <link rel="manifest" href="/images/favicons/manifest.json">
  <link rel="shortcut icon" href="/images/favicons/favicon.ico">
  <meta name="msapplication-TileColor" content="#ffc40d">
  <meta name="msapplication-TileImage" content="/images/favicons/mstile-144x144.png">
  <meta name="theme-color" content="#ffffff">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="stylesheet" href="/css/font-awesome-4.6.3/css/font-awesome.min.css">
  <link rel="canonical" href="http://iFanze.cn//2016/05/Laravel-v5.2-%E6%A1%86%E6%9E%B6%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0-%E4%B8%80-%E5%9F%BA%E7%A1%80/">
  <link rel="alternate" type="application/rss+xml" title="Meng Fanze" href="/feed.xml">

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?10581c22432798705ab269dd1ce9615c";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>

</head>


  <body>
    <span class="mobile btn-mobile-menu">
  <i class="icon icon-list btn-mobile-menu__icon"></i>
  <i class="icon icon-x-circle btn-mobile-close__icon hidden"></i>
</span>
  
<header class="panel-cover" style="background-image: url(/images/cover.jpg)">
  <div class="panel-main">

    <div class="panel-main__inner panel-inverted">
    <div class="panel-main__content">
        <a href="/" title="link to home of Meng Fanze">
          <img src="/images/profile.jpg" class="user-image" alt="My Profile Photo">
          <h1 class="panel-cover__title panel-title">Meng Fanze</h1>
        </a>
        <hr class="panel-cover__divider">
        <p class="panel-cover__description">求知，思考，高效生活</p>
        <hr class="panel-cover__divider panel-cover__divider--secondary">

        <div class="navigation-wrapper">

          <nav class="cover-navigation cover-navigation--primary">
            <ul class="navigation">
              <li class="navigation__item"><a href="/#blog" title="link to Meng Fanze blog" class="blog-button">主页</a></li>
              <li class="navigation__item"><a href="/tags" title="标签" class="blog-button">标签</a></li>
              <li class="navigation__item"><a href="/categories" title="分类" class="blog-button">分类</a></li>
              <li class="navigation__item"><a href="/about" title="关于我" class="blog-button">关于</a></li>
            </ul>
          </nav>

          <nav class="cover-navigation navigation--social">
            <ul class="navigation">
          
            
              <!-- QQ -->
              <li class="navigation__item">
                <a href="/about/#contact" title="QQ:919446762 微信:iFanze">
                  <i class="fa fa-qq" aria-hidden="true"></i>
                  <span class="label">QQ</span>
                </a>
              </li>
            

            
              <!-- 微博 -->
              <li class="navigation__item">
                <a href="http://weibo.com/ichen0201" title="新浪微博" target="_blank">
                  <i class="fa fa-weibo" aria-hidden="true"></i>
                  <span class="label">微博</span>
                </a>
              </li>
            

            
              <!-- 知乎 -->
              <li class="navigation__item">
                <a href="https://www.zhihu.com/people/iFanze" title="知乎" target="_blank">
                  <i class="fa" aria-hidden="true">知</i>
                  <span class="label">知乎</span>
                </a>
              </li>
            

            
              <!-- GitHub -->
              <li class="navigation__item">
                <a href="https://www.github.com/iFanze" title="iFanze on GitHub" target="_blank">
                  <i class="fa fa-github fa-lg" aria-hidden="true"></i>
                  <span class="label">Github</span>
                </a>
              </li>
            

            
              <!-- Email -->
              <li class="navigation__item">
                <a href="mailto:iFanze@outlook.com" title="Email iFanze@outlook.com" target="_blank">
                  <i class="fa fa-envelope fa-fw" aria-hidden="true"></i>
                  <span class="label">E-mail</span>
                </a>
              </li>
            

            <!-- RSS -->
            <li class="navigation__item">
              <a href="/feed.xml" title="Subscribe" target="_blank">
                  <i class="fa fa-rss fa-fw" aria-hidden="true"></i>
                  <span class="label">RSS</span>
              </a>
            </li>
          
            <!-- About me 
            <li class="navigation__item">
              <a href="/about" title="About me">
                  <i class="fa fa-info fa-fw" aria-hidden="true"></i>
                  <span class="label">About me</span>
              </a>
            </li>
            -->
            </ul>
          </nav>

        </div>

      </div>

    </div>

    <div class="panel-cover--overlay"></div>
  </div>
</header>


    <div class="content-wrapper">
      <div class="content-wrapper__inner">
        <article class="post-container post-container--single">
  <header class="post-header">
    <div class="post-meta">
      <time datetime="27 May 2016" class="post-meta__date date">27 May 2016</time> &#8226; <span class="post-meta__tags">on <a href="/tags/#PHP">PHP</a> </span>
    </div>
    <h1 class="post-title">Laravel v5.2 框架学习笔记（一）：基础</h1>
  </header>

  <section class="post">
    <p>注：写完上一篇ThinkPHP框架，再写一篇Laravel框架的学习笔记感觉好怪异。主要是因为在知乎上看到了一些PHP框架相关的讨论，有很多人力推Laravel，又说ThinkPHP哪里怎么怎么不合理，代码质量一般，风格糟糕等等……然后就打开Laravel官网看了一眼，仅仅是打开看了一眼，我就决定抛弃掉ThinkPHP转投看着很高大上的Laravel了！！</p>

<p>注2：新开一段理智下来，Laravel更显专业、成熟，学着更具挑战性，我还可能会从其优秀的代码风格中受益，框架自身也足够稳定。当然也不是说ThinkPHP就不好，或许用来写一般的应用同样简洁高效，并且是国产基因，有中文文档，这些都是他的优点。</p>

<p>注3：这里记录下官方文档里最基础的几篇，可以快速入门，了解基本运行流程并新建一个涉及简单数据库读写的站点。</p>

<h2 id="laravel">安装并创建Laravel项目</h2>

<ul>
  <li>需要使用Composer。这个在上次装ThinkPHP的时候已经装了。不使用国内的镜像的话安装速度会很慢。</li>
</ul>

<h3 id="laravel-installer">方式一：使用Laravel installer创建项目</h3>

<div class="highlighter-rouge"><pre class="highlight"><code>composer global require <span class="s2">"laravel/install"</span>   <span class="c">#laravel会被安装到：~/.composer/verdor/bin，把它加入PATH</span>
laravel new blog    <span class="c">#创建一个项目，目录名称为blog</span>
laravel new         <span class="c">#如果新建了一个Git库，并想让laravel生成在库的根目录下，使用这个语句</span>
</code></pre>
</div>

<h3 id="composer-create-project">方式二：使用composer create-project</h3>

<div class="highlighter-rouge"><pre class="highlight"><code>composer create-project --prefer-dist laravel/laravel blog
</code></pre>
</div>

<h2 id="section">第一次运行</h2>

<ul>
  <li>在Apache中新建虚拟主机，配置网站的根目录为所创建项目下的<code class="highlighter-rouge">public</code>目录。具体方法见之前写的博客（编辑<code class="highlighter-rouge">httpd-vhosts.conf</code>和<code class="highlighter-rouge">/etc/hosts</code>文件）。</li>
  <li>要配置<code class="highlighter-rouge">storage</code>和<code class="highlighter-rouge">bootstrap/cache</code>目录的访问权限，至少755。</li>
  <li>在浏览器访问配置的主机名进行测试：
<img src="/images/posts/14647055338077.jpg" alt="" /></li>
</ul>

<h2 id="section-1">环境配置</h2>

<ul>
  <li>在<code class="highlighter-rouge">.env</code>中配置环境信息，其中<code class="highlighter-rouge">APP_ENV</code>即是环境名。</li>
  <li><code class="highlighter-rouge">.env</code>不要使用版本控制，而应该使用<code class="highlighter-rouge">.env.example</code>。</li>
</ul>

<h3 id="section-2">环境配置的读取</h3>

<div class="highlighter-rouge"><pre class="highlight"><code>env('APP_DEBUG', false)     //第二个参数为默认值
</code></pre>
</div>

<h3 id="section-3">判断当前环境</h3>

<div class="highlighter-rouge"><pre class="highlight"><code>$environment = App::environment();
//或者
if(App::environment('local', 'staging')){
    // 环境是local或者staging
}
//或者
$environment = app()-&gt;environment();
</code></pre>
</div>

<h2 id="section-4">项目配置</h2>

<ul>
  <li>配置文件位于<code class="highlighter-rouge">config</code>目录。</li>
</ul>

<h3 id="section-5">配置的访问</h3>

<div class="highlighter-rouge"><pre class="highlight"><code>$value = config('app.timezone');                //可以再设置默认值
</code></pre>
</div>

<h3 id="section-6">临时改变项目配置</h3>

<div class="highlighter-rouge"><pre class="highlight"><code>config(['app.timezone' =&gt; 'America/Chicago']);  
</code></pre>
</div>

<h2 id="section-7">项目维护</h2>

<h3 id="section-8">缓存的使用</h3>

<ul>
  <li>为了提升性能，在生产环境中定期运行下面的命令可以将配置文件转成单个文件，在开发环境中不要用。</li>
</ul>

<div class="highlighter-rouge"><pre class="highlight"><code>php artisan config:cache
php artisan config:clear
</code></pre>
</div>

<h3 id="section-9">开启维护模式</h3>

<ul>
  <li>开启Maintenance Mode，可以对所有请求展示一个自定义视图，默认是<code class="highlighter-rouge">resources/views/errors/503.blade.php</code>。应在系统维护期使用。（<a href="https://laravel.com/docs/5.2/configuration#maintenance-mode">更多：关于队列任务和zero-downtime发布的实现</a>）开启和关闭的指令分别是：</li>
</ul>

<div class="highlighter-rouge"><pre class="highlight"><code>php artisan down
php artisan up
</code></pre>
</div>

<h2 id="section-10">路由</h2>

<ul>
  <li>定义在<code class="highlighter-rouge">app/Http/routes.php</code>。</li>
  <li>支持的HTTP verb：</li>
</ul>

<div class="highlighter-rouge"><pre class="highlight"><code>Route::get($uri, $callback);
Route::post($uri, $callback);
Route::put($uri, $callback);
Route::patch($uri, $callback);
Route::delete($uri, $callback);
Route::options($uri, $callback);
</code></pre>
</div>

<ul>
  <li>如果希望支持多个或者任意HTTP verb：</li>
</ul>

<div class="highlighter-rouge"><pre class="highlight"><code>Route::match(['get', 'post'], '/', $callback);
Route::any('/', $callback);
</code></pre>
</div>

<ul>
  <li><code class="highlighter-rouge">$callback</code>既可以是匿名函数，也可以指定控制器下的方法，如：</li>
</ul>

<div class="highlighter-rouge"><pre class="highlight"><code>Route::get('/', HomeController@index);
</code></pre>
</div>

<h3 id="section-11">路由的参数</h3>

<ul>
  <li>必选参数：</li>
</ul>

<div class="highlighter-rouge"><pre class="highlight"><code>Route::get('posts/{post}/comments/{comment}', function ($postId, $commentId) {
    //
});
</code></pre>
</div>

<ul>
  <li>可选参数：</li>
</ul>

<div class="highlighter-rouge"><pre class="highlight"><code>Route::get('user/{name?}', function ($name = null) {
    //注意，$name要有默认值
});
</code></pre>
</div>
<hr />

<ul>
  <li>使用正则表达式对参数进行限制：</li>
</ul>

<div class="highlighter-rouge"><pre class="highlight"><code>Route::get('user/{id}/{name}', function ($id, $name) {
    //
})
-&gt;where(['id' =&gt; '[0-9]+', 'name' =&gt; '[a-z]+']);
</code></pre>
</div>

<ul>
  <li>使用正则表达式在项目全局范围内限制某参数：</li>
</ul>

<div class="highlighter-rouge"><pre class="highlight"><code>// 位于：app/Providers/RouteServiceProvider.php
public function boot(Router $router)
{
    $router-&gt;pattern('id', '[0-9]+');
    parent::boot($router);
}
</code></pre>
</div>

<h3 id="section-12">命名路由</h3>

<ul>
  <li>三种方式：</li>
</ul>

<div class="highlighter-rouge"><pre class="highlight"><code>Route::get('user/profile', ['as' =&gt; 'profile', function () {
    //
}]);

Route::get('user/profile', [
    'as' =&gt; 'profile', 'uses' =&gt; 'UserController@showProfile'
]);

Route::get('user/profile', 'UserController@showProfile')-&gt;name('profile');

</code></pre>
</div>

<ul>
  <li>继而可以进行路由分组：</li>
</ul>

<div class="highlighter-rouge"><pre class="highlight"><code>Route::group(['as' =&gt; 'admin::'], function () {
    Route::get('dashboard', ['as' =&gt; 'dashboard', function () {
        // Route named "admin::dashboard"
    }]);
});
</code></pre>
</div>

<ul>
  <li>利用路由名称得到URL或进行重定向：</li>
</ul>

<div class="highlighter-rouge"><pre class="highlight"><code>$url = route('profile');
$url = route('profile', ['id' =&gt; 1]);   //带参数的写法

return redirect()-&gt;route('profile');    //重定向
</code></pre>
</div>

<h3 id="section-13">路由分组的常见用途</h3>

<ul>
  <li>公共的中间件：</li>
</ul>

<div class="highlighter-rouge"><pre class="highlight"><code>Route::group(['middleware' =&gt; 'auth'], function () {
    Route::get('/', function ()    {
        // Uses Auth Middleware
    });

    Route::get('user/profile', function () {
        // Uses Auth Middleware
    });
});
</code></pre>
</div>

<ul>
  <li>公共的命名空间（不用指定前缀<code class="highlighter-rouge">App\Http\Controllers</code>）：</li>
</ul>

<div class="highlighter-rouge"><pre class="highlight"><code>Route::group(['namespace' =&gt; 'Admin'], function()
{
    // Controllers Within The "App\Http\Controllers\Admin" Namespace

    Route::group(['namespace' =&gt; 'User'], function() {
        // Controllers Within The "App\Http\Controllers\Admin\User" Namespace
    });
});
</code></pre>
</div>

<ul>
  <li>公共的子域名：</li>
</ul>

<div class="highlighter-rouge"><pre class="highlight"><code>Route::group(['domain' =&gt; '{account}.myapp.com'], function () {
    Route::get('user/{id}', function ($account, $id) {
        //
    });
});
</code></pre>
</div>

<ul>
  <li>公共的路由前缀：</li>
</ul>

<div class="highlighter-rouge"><pre class="highlight"><code>Route::group(['prefix' =&gt; 'admin'], function () {
    Route::get('users', function ()    {
        // Matches The "/admin/users" URL
    });
});

Route::group(['prefix' =&gt; 'accounts/{account_id}'], function () {
    Route::get('detail', function ($accountId)    {
        // Matches The "/accounts/{account_id}/detail" URL
    });
});
</code></pre>
</div>

<h3 id="csrf">CSRF的防御</h3>

<ul>
  <li>关于CSRF（Cross-site request forgery，跨站请求伪造）：<a href="http://www.cnblogs.com/hyddd/archive/2009/04/09/1432744.html">查看详情</a></li>
  <li>在表单中使用：</li>
</ul>

<div class="highlighter-rouge"><pre class="highlight"><code>
</code></pre>
</div>

<p>等价于：</p>

<div class="highlighter-rouge"><pre class="highlight"><code>&lt;input type="hidden" name="_token" value="&lt;?php echo csrf_token(); ?&gt;"&gt;
</code></pre>
</div>

<ul>
  <li>web中间件组中的VerifyCsrfToken中间件会帮助你完成认证工作。</li>
  <li>如果想排除对某些URI使用CSRF保护，可以defining their routes outside of the web middleware group that is included in the default routes.php file，或者编辑：</li>
</ul>

<div class="highlighter-rouge"><pre class="highlight"><code>// app/Http/Middleware/VerifyCsrfToken.php
protected $except = [
   'stripe/*',
];
</code></pre>
</div>

<ul>
  <li><code class="highlighter-rouge">X-CSRF-TOKEN</code>和<code class="highlighter-rouge">X-XSRF-TOKEN</code>就不说了，用到时再去了解吧。</li>
</ul>

<h3 id="section-14">路由中的模型绑定</h3>

<h4 id="section-15">隐式绑定</h4>

<ul>
  <li>Laravel会自动寻找到ID与<code class="highlighter-rouge"><span class="p">{</span><span class="err">user</span><span class="p">}</span></code>匹配的<code class="highlighter-rouge">User</code>模型实例，如果找不到，会返回404。</li>
</ul>

<div class="highlighter-rouge"><pre class="highlight"><code>Route::get('api/users/{user}', function (App\User $user) {
    return $user-&gt;email;
});
</code></pre>
</div>

<ul>
  <li>如果并不使用<code class="highlighter-rouge">id</code>列进行查找，可以在model中重写：</li>
</ul>

<div class="highlighter-rouge"><pre class="highlight"><code>public function getRouteKeyName()
{
    return 'slug';
}
</code></pre>
</div>

<h4 id="section-16">显式绑定</h4>

<ul>
  <li>如果要将参数名和模型绑定，编辑<code class="highlighter-rouge">RouteServiceProvider::boot</code>方法：</li>
</ul>

<div class="highlighter-rouge"><pre class="highlight"><code>public function boot(Router $router)
{
    parent::boot($router);
    //将{user}绑定到App\User，默认寻找的是id列
    $router-&gt;model('user', 'App\User');
}
</code></pre>
</div>

<ul>
  <li>如果要自定义寻找规则，编辑<code class="highlighter-rouge">routes.php</code>文件，增加：</li>
</ul>

<div class="highlighter-rouge"><pre class="highlight"><code>$router-&gt;bind('user', function ($value) {
    return App\User::where('name', $value)-&gt;first();
});
</code></pre>
</div>

<ul>
  <li>如果要自定义”not found“行为，就新增第三个参数：</li>
</ul>

<div class="highlighter-rouge"><pre class="highlight"><code>$router-&gt;model('user', 'App\User', function () {
    throw new NotFoundHttpException;
});
</code></pre>
</div>

<h3 id="putdeleteput">表单提交模拟PUT/DELETE/PUT等</h3>

<ul>
  <li>使用以下三种方式之一：</li>
</ul>

<div class="highlighter-rouge"><pre class="highlight"><code>&lt;input type="hidden" name="_method" value="PUT"&gt;
&lt;?php echo method_field('PUT'); ?&gt;

</code></pre>
</div>

<h3 id="section-17">查看当前路由</h3>

<div class="highlighter-rouge"><pre class="highlight"><code>$route = Route::current();
$name = $route-&gt;getName();
$actionName = $route-&gt;getActionName();
//或
$name = Route::currentRouteName();
$action = Route::currentRouteAction();
</code></pre>
</div>

<h2 id="section-18">中间件</h2>

<h3 id="section-19">创建中间件</h3>

<div class="highlighter-rouge"><pre class="highlight"><code>php artisan make:middleware AgeMiddleware
</code></pre>
</div>

<p>会自动生成：</p>

<div class="highlighter-rouge"><pre class="highlight"><code>public function handle($request, Closure $next)
{
   return $next($request);
}
</code></pre>
</div>

<p>使用示例：</p>

<div class="highlighter-rouge"><pre class="highlight"><code>public function handle($request, Closure $next)
{
   if ($request-&gt;input('age') <span class="err">&lt;</span>= 200) {
       return redirect('home');
   }
   return $next($request);
}
</code></pre>
</div>

<h3 id="beforeafter">两种中间件：Before/After</h3>

<div class="highlighter-rouge"><pre class="highlight"><code>public function handle($request, Closure $next)
{
   // Perform action
   return $next($request);
}

public function handle($request, Closure $next)
{
   $response = $next($request);
   // Perform action
   return $response;
}
</code></pre>
</div>

<h3 id="section-20">注册中间件</h3>

<h4 id="section-21">全局中间件</h4>

<ul>
  <li>编辑<code class="highlighter-rouge">app/Http/Kernel.php</code>中的<code class="highlighter-rouge">$middleware</code>属性，让所有请求都使用中间件。</li>
</ul>

<h4 id="section-22">分配中间件给路由</h4>

<ul>
  <li>首先在<code class="highlighter-rouge">app/Http/Kernel.php</code>中的<code class="highlighter-rouge">$routeMiddleware</code>中注册个名字。</li>
  <li>四种方式分配：</li>
</ul>

<div class="highlighter-rouge"><pre class="highlight"><code>Route::get('admin/profile', ['middleware' =&gt; 'auth', function () {
}]);

Route::get('/', ['middleware' =&gt; ['first', 'second'], function () {
}]);

Route::get('/', function () {
})-&gt;middleware(['first', 'second']);

use App\Http\Middleware\FooMiddleware;
Route::get('admin/profile', ['middleware' =&gt; FooMiddleware::class, function () {
}]);
</code></pre>
</div>

<h3 id="section-23">中间件分组</h3>

<ul>
  <li>编辑<code class="highlighter-rouge">app/Http/Kernel.php</code>中的<code class="highlighter-rouge">$middlewareGroups</code>属性。默认创建了<code class="highlighter-rouge">web</code>和<code class="highlighter-rouge">api</code>两个分组。</li>
  <li>可以将中间件组分配给路由：</li>
</ul>

<div class="highlighter-rouge"><pre class="highlight"><code>Route::group(['middleware' =&gt; ['web']], function () {
    //
});
</code></pre>
</div>

<p>注意：web中间件已经自动应用到了所有路由，在<code class="highlighter-rouge">RouteServiceProvider</code>里。</p>

<h3 id="section-24">中间件参数</h3>

<ul>
  <li>如用户权限的判断，在<code class="highlighter-rouge">$next</code>后新增参数：</li>
</ul>

<div class="highlighter-rouge"><pre class="highlight"><code>public function handle($request, Closure $next, $role)
{
   if (! $request-&gt;user()-&gt;hasRole($role)) {
       // Redirect...
   }
   return $next($request);
}
</code></pre>
</div>

<ul>
  <li>在路由定义中指定参数，用冒号将中间件名和参数分开，过个参数用逗号分开：</li>
</ul>

<div class="highlighter-rouge"><pre class="highlight"><code>Route::put('post/{id}', ['middleware' =&gt; 'role:editor', function ($id) {
    //
}]);
</code></pre>
</div>

<h3 id="terminable-middleware">有终止的中间件（Terminable Middleware）</h3>

<ul>
  <li>如果要在HTTP响应发送之后做一些事情，就要添加<code class="highlighter-rouge">terminate($request, $response)</code>方法，还需要将它在HTTP Kernel中添加到全局中间件。</li>
</ul>

<div class="highlighter-rouge"><pre class="highlight"><code>class StartSession
{
    public function handle($request, Closure $next)
    {
        return $next($request);
    }

    public function terminate($request, $response)
    {
        // Store the session data...
    }
}
</code></pre>
</div>

<p>注意：执行<code class="highlighter-rouge">handle</code>和<code class="highlighter-rouge">terminate</code>的方法的是服务容器中的两个中间件实例，如果想单例调用，要在容器中使用它的<code class="highlighter-rouge">singleton</code>方法注册中间件。</p>

<h2 id="section-25">控制器</h2>

<h3 id="section-26">基本控制器</h3>

<div class="highlighter-rouge"><pre class="highlight"><code>//定义控制器
class UserController extends Controller
{
    public function showProfile($id)
    {
        return view('user.profile', ['user' =&gt; User::findOrFail($id)]);
    }
}

//添加路由
Route::get('user/{id}', 'UserController@showProfile');  //这里可以省略命名空间，全写是'App\Http\Controllers\UserController'

//命名路由
Route::get('foo', ['uses' =&gt; 'FooController@method', 'as' =&gt; 'name']);
//根据路由名字得出Url
$url = route('name');
</code></pre>
</div>

<h3 id="section-27">控制器上应用中间件</h3>

<div class="highlighter-rouge"><pre class="highlight"><code>//方法1
Route::get('profile', [
    'middleware' =&gt; 'auth',
    'uses' =&gt; 'UserController@showProfile'
]);

//方法2：在控制器构造函数使用`middleware`函数，甚至可以只对控制器中的个别方法应用中间件
class UserController extends Controller
{
    public function __construct()
    {
        $this-&gt;middleware('auth');

        $this-&gt;middleware('log', ['only' =&gt; [
            'fooAction',
            'barAction',
        ]]);

        $this-&gt;middleware('subscribed', ['except' =&gt; [
            'fooAction',
            'barAction',
        ]]);
    }
}
</code></pre>
</div>

<h3 id="restful">RESTful资源控制器</h3>

<ul>
  <li>创建：</li>
</ul>

<div class="highlighter-rouge"><pre class="highlight"><code>php artisan make:controller PhotoController --resource
</code></pre>
</div>

<ul>
  <li>注册路由：</li>
</ul>

<div class="highlighter-rouge"><pre class="highlight"><code>//全部
Route::resource('photo', 'PhotoController');

//个别
Route::resource('photo', 'PhotoController', ['only' =&gt; [
    'index', 'show'
]]);
Route::resource('photo', 'PhotoController', ['except' =&gt; [
    'create', 'store', 'update', 'destroy'
]]);
</code></pre>
</div>
<p><img src="/images/posts/14653777955891.jpg" alt="" /></p>

<ul>
  <li>如果不想要默认的Route Name：</li>
</ul>

<div class="highlighter-rouge"><pre class="highlight"><code>Route::resource('photo', 'PhotoController', ['names' =&gt; [
    'create' =&gt; 'photo.build'
]]);
</code></pre>
</div>

<ul>
  <li>如果不想要默认的路由参数名（默认是根据资源名）：</li>
</ul>

<div class="highlighter-rouge"><pre class="highlight"><code>//对应：/user/{admin_user}
Route::resource('user', 'AdminUserController', ['parameters' =&gt; [
    'user' =&gt; 'admin_user'
]]);

//单数化参数，对应：/users/{user}/photos/{photo}
Route::resource('users.photos', 'PhotoController', [
    'parameters' =&gt; 'singular'
]);

//统一配置对应参数：
Route::resourceParameters([
    'user' =&gt; 'person', 'photo' =&gt; 'image'
]);

//全局配置使用单数化
Route::singularResourceParameters();

//优先级依次降低（前两种相同）
</code></pre>
</div>

<ul>
  <li>如果要新增更多的action，要写在<code class="highlighter-rouge">Route::resource</code>之前：</li>
</ul>

<div class="highlighter-rouge"><pre class="highlight"><code>Route::get('photos/popular', 'PhotoController@method');
Route::resource('photos', 'PhotoController');
</code></pre>
</div>

<h3 id="section-28">依赖注入与控制器</h3>

<h4 id="section-29">构造函数注入</h4>

<div class="highlighter-rouge"><pre class="highlight"><code>namespace App\Http\Controllers;
use App\Repositories\UserRepository;
class UserController extends Controller
{
    protected $users;
    
    public function __construct(UserRepository $users)
    {
        $this-&gt;users = $users;
    }
}
</code></pre>
</div>

<p>注：如果容器可以解析，你就可以指定任意Laravel contract。</p>

<h4 id="section-30">方法注入</h4>

<div class="highlighter-rouge"><pre class="highlight"><code>//注入Illuminate\Http\Request
use Illuminate\Http\Request;
class UserController extends Controller
{
    public function store(Request $request)
    {
        $name = $request-&gt;input('name');
        //
    }
}

//如果路由需要参数
Route::put('user/{id}', 'UserController@update');
class UserController extends Controller
{
    public function update(Request $request, $id)
    {
        
    }
}

</code></pre>
</div>

<h3 id="section-31">路由缓存</h3>

<ul>
  <li>缓存不适用于闭包路由</li>
  <li>使用缓存可以减少路由注册所花费的时间，甚至可以提速100%。同样别在开发环境用。</li>
  <li>使用以下命令开关：</li>
</ul>

<div class="highlighter-rouge"><pre class="highlight"><code>php artisan route:cache
php artisan route:clear
</code></pre>
</div>

<h2 id="section-32">请求</h2>

<h3 id="request">访问Request</h3>

<div class="highlighter-rouge"><pre class="highlight"><code>namespace App\Http\Controllers;
use Illuminate\Http\Request;
class UserController extends Controller
{
    public function update(Request $request, $id)   //id传自路由
    {
        
    }
}
</code></pre>
</div>

<h3 id="section-33">基本请求信息</h3>

<div class="highlighter-rouge"><pre class="highlight"><code>$request-&gt;path();           //返回格式："/foo/bar"
$request-&gt;url();            //返回格式："http://domain.com/foo"
$request-&gt;fullUrl();        //返回格式："http://domain.com/foo?bar=baz"
$request-&gt;fullUrlWithQuery(['bar' =&gt; 'baz']);   //返回格式："http://domain.com/foo?bar=baz"
$request-&gt;is('admin/*');    //返回true或false
$request-&gt;isMethod('post'); //返回true或false

$name = $request-&gt;input('name');            //不管get/post
$name = $request-&gt;input('name', 'Sally');   //带默认值
$name = $request-&gt;input('products.0.name'); //读入数组中的某个特定元素
$names = $request-&gt;input('products.*.name');//读入数组
$name = $request-&gt;input('user.name');       //读取Json格式的请求，需要Content-Type是"Json"
$request-&gt;has('name');                      //判断
$request-&gt;all();                            //读入所有数据为数组
$input = $request-&gt;only(['username', 'password']);  //读入部分数据为数组
$input = $request-&gt;only('username', 'password');
$input = $request-&gt;except(['credit_card']);
$input = $request-&gt;except('credit_card');

$name = $request-&gt;name;                     //利用动态属性访问，Laravel会首先匹配请求参数，再匹配路由参数

</code></pre>
</div>

<h3 id="laravelpsr-7">将经典Laravel请求和响应转成PSR-7</h3>

<ul>
  <li>安装以下库：</li>
</ul>

<div class="highlighter-rouge"><pre class="highlight"><code>composer require symfony/psr-http-message-bridge
composer require zendframework/zend-diactoros
</code></pre>
</div>

<ul>
  <li>格式：</li>
</ul>

<div class="highlighter-rouge"><pre class="highlight"><code>use Psr\Http\Message\ServerRequestInterface;
Route::get('/', function (ServerRequestInterface $request) {
    //返回的PSR-7响应会自动转成经典Laravel响应。
});
</code></pre>
</div>

<h3 id="section-34">将输入保存到下次请求</h3>

<div class="highlighter-rouge"><pre class="highlight"><code>//将输入存入Session
$request-&gt;flash();
$request-&gt;flashOnly(['username', 'email']);
$request-&gt;flashExcept('password');
//将输入存入Session然后重定向
return redirect('form')-&gt;withInput();
return redirect('form')-&gt;withInput($request-&gt;except('password'));
//重新获取旧数据
$username = $request-&gt;old('username');
//在Blade template中获取旧数据，如果没有数据返回null
<span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"text"</span> <span class="na">name=</span><span class="s">"username"</span> <span class="na">value=</span><span class="s">""</span><span class="nt">&gt;</span>
</code></pre>
</div>

<h3 id="cookies">Cookies</h3>

<ul>
  <li>使用Laravel创建的Cookie都是加密的，如果客户端改变了它就会无效。</li>
</ul>

<div class="highlighter-rouge"><pre class="highlight"><code>//获取cookie
$value = $request-&gt;cookie('name');
$response = new Illuminate\Http\Response('Hello World');

//返回cookie
$response-&gt;withCookie('name', 'value', $minutes);
return $response;

//返回永久cookie（5年）
$response-&gt;withCookie(cookie()-&gt;forever('name', 'value'));
</code></pre>
</div>

<h3 id="section-35">请求中的文件</h3>

<div class="highlighter-rouge"><pre class="highlight"><code>$request-&gt;file('photo');    //返回Symfony\Component\HttpFoundation\File\UploadedFile对象，这个对象扩展了PHP的SplFileInfo，提供很多与文件交互的方法
$request-&gt;hasFile('photo'); //返回bool，判断文件是否在请求中存在
$request-&gt;file('photo')-&gt;isValid(); //返回bool，确定文件是否上传成功

$request-&gt;file('photo')-&gt;move($destinationPath);    //移动上传的文件（从PHP配置的临时目录移动到特定目录）
$request-&gt;file('photo')-&gt;move($destinationPath, $fileName);
</code></pre>
</div>

<p>-<a href="http://api.symfony.com/3.0/Symfony/Component/HttpFoundation/File/UploadedFile.html">更多UploadedFile的API。</a></p>

<h2 id="section-36">响应</h2>

<h3 id="section-37">基本响应</h3>

<div class="highlighter-rouge"><pre class="highlight"><code>//返回字符串
return 'Hello World';
//返回对象（Illuminate\Http\Response，可自定义HTTP状态码和headers，继承自Symfony\Component\HttpFoundation\Response,提供创建响应的方法。）
return (new Response($content, $status))-&gt;header('Content-Type', $value);
//使用response helper简化：
return response($content, $status)-&gt;header('Content-Type', $value);

//指定headers的两种方法
return response($content)
            -&gt;header('Content-Type', $type)
            -&gt;header('X-Header-One', 'Header Value')
            -&gt;header('X-Header-Two', 'Header Value');
return response($content)
            -&gt;withHeaders([
                'Content-Type' =&gt; $type,
                'X-Header-One' =&gt; 'Header Value',
                'X-Header-Two' =&gt; 'Header Value',
            ]);
            
//指定cookies
return response($content)
                -&gt;header('Content-Type', $type)
                -&gt;cookie('name', 'value');
//完整版的cookie函数
-&gt;cookie($name, $value, $minutes, $path, $domain, $secure, $httpOnly)
//在方法中使用Cookie::queue添加
public function index()
{
   Cookie::queue('saw_dashboard', true, 15);
   return view('dashboard');
}
//取消对cookie的加密：在App\Http\Middleware\EncryptCookies中间件中配置$except，填入不想加密的cookie的名字
</code></pre>
</div>

<h3 id="section-38">其它响应</h3>

<div class="highlighter-rouge"><pre class="highlight"><code>//视图响应：不用传递HTTP状态码和headers
return response()
            -&gt;view('hello', $data)
            -&gt;header('Content-Type', $type);
//JSON响应：自动设置Content-Type为application/json，自动将参数用json_encode转成字符串
return response()-&gt;json(['name' =&gt; 'Abigail', 'state' =&gt; 'CA']);
//JSONP响应：后再接setCallback
return response()
            -&gt;json(['name' =&gt; 'Abigail', 'state' =&gt; 'CA'])
            -&gt;setCallback($request-&gt;input('callback'));
//文件下载响应（$name是默认文件名，Symfony HttpFoudation要求文件名是ASCII）：
return response()-&gt;download($pathToFile);
return response()-&gt;download($pathToFile, $name, $headers);
</code></pre>
</div>

<h3 id="section-39">重定向</h3>

<div class="highlighter-rouge"><pre class="highlight"><code>//基本的重定向
return redirect('home/dashboard');

//浏览器后退，注意保证这个路由在使用web中间件组或者拥有所有session中间件应用的
return back()-&gt;withInput();

//重定向到命名路由
return redirect()-&gt;route('login');
return redirect()-&gt;route('profile', ['id' =&gt; 1]);
return redirect()-&gt;route('profile', [$user]);   //$user是Eloquent Model，会自动使用ID属性。

//重定向到控制器方法（也可以再加路由参数）
return redirect()-&gt;action('HomeController@index');

//带Session的重定向
Route::post('user/profile', function () {
    // Update the user's profile...
    return redirect('dashboard')-&gt;with('status', 'Profile updated!');
});
//在模板中获得session
@if (session('status'))
    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"alert alert-success"</span><span class="nt">&gt;</span>
        
    <span class="nt">&lt;/div&gt;</span>
@endif
</code></pre>
</div>

<h3 id="section-40">响应宏</h3>

<div class="highlighter-rouge"><pre class="highlight"><code>//在App/Providers目录下的service provider类的boot方法中添加：
namespace App\Providers;

use Response;
use Illuminate\Support\ServiceProvider;

class ResponseMacroServiceProvider extends ServiceProvider
{
    /**
     * Perform post-registration booting of services.
     *
     * @return void
     */
    public function boot()
    {
        Response::macro('caps', function ($value) {
            return Response::make(strtoupper($value));
        });
    }
}
//使用response方法或者ResponsFactory的实现来使用定义的宏：
return response()-&gt;caps('foo');
</code></pre>
</div>

<h2 id="section-41">视图</h2>

<h3 id="section-42">基本用法</h3>

<div class="highlighter-rouge"><pre class="highlight"><code>return view('greeting', ['name' =&gt; 'James']);
return view('admin.profile', $data);            //位于resources/views/admin/profile.php
view()-&gt;exists('emails.customer')               //返回bool，判断是否存在
view()                                          //返回Illuminate\Contracts\View\Factory的实例，可以使用该工厂类的方法

return view('greeting')-&gt;with('name', 'Victoria');  //传一对独立的参数

//与所有视图共享数据，在服务容器的boot方法中调用view()-&gt;share()
class AppServiceProvider extends ServiceProvider
{
    public function boot()
    {
        view()-&gt;share('key', 'value');
    }

    public function register()
    {
        //
    }
}
</code></pre>
</div>

<h3 id="view-composers">View Composers</h3>

<ul>
  <li>是视图呈现时被调用的回调函数或类成员函数。如果想每次视图呈现时都绑定一些数据，它可以帮你在一个地方组织相关的逻辑。Laravel并没有为之提供默认的目录，这里我们创建<code class="highlighter-rouge">App\Http\ViewComposers</code>，在其中定义composer类。：</li>
</ul>

<div class="highlighter-rouge"><pre class="highlight"><code>namespace App\Providers;
use Illuminate\Support\ServiceProvider;
//新建的service provider，要对config/app.php的providers进行配置。
class ComposerServiceProvider extends ServiceProvider
{
    public function boot()
    {
        // Using class based composers...
        view()-&gt;composer(
            'profile', 'App\Http\ViewComposers\ProfileComposer'
        );

        // Using Closure based composers...
        view()-&gt;composer('dashboard', function ($view) {
            //
        });
    }

    public function register()
    {
        //
    }
}
</code></pre>
</div>

<ul>
  <li>这样，每次调用视图，<code class="highlighter-rouge">ProfileComposer@compose</code>就会被执行：</li>
</ul>

<div class="highlighter-rouge"><pre class="highlight"><code>namespace App\Http\ViewComposers;

use Illuminate\View\View;
use App\Repositories\UserRepository;

class ProfileComposer
{
    protected $users;

    public function __construct(UserRepository $users)
    {
        $this-&gt;users = $users;
    }

    public function compose(View $view)
    {
        $view-&gt;with('count', $this-&gt;users-&gt;count());
    }
}

</code></pre>
</div>

<ul>
  <li>可以将一个composer用于多个视图：</li>
</ul>

<div class="highlighter-rouge"><pre class="highlight"><code>view()-&gt;composer(
    ['profile', 'dashboard'],
    'App\Http\ViewComposers\MyViewComposer'
);

view()-&gt;composer('*', function ($view) {
    //
});
</code></pre>
</div>

<ul>
  <li>View Creators的作用和Composers类似，但前者是视图被初始化时调用，后者是将要呈现（render）时调用。注册view creator的方法如下：</li>
</ul>

<div class="highlighter-rouge"><pre class="highlight"><code>view()-&gt;creator('profile', 'App\Http\ViewCreators\ProfileCreator');
</code></pre>
</div>

<h2 id="blade">Blade模板</h2>

<h3 id="section-43">定义布局</h3>

<ul>
  <li><code class="highlighter-rouge">@section</code>和<code class="highlighter-rouge">@yield</code>。</li>
</ul>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="c">&lt;!-- Stored in resources/views/layouts/master.blade.php --&gt;</span>
<span class="nt">&lt;html&gt;</span>
    <span class="nt">&lt;head&gt;</span>
        <span class="nt">&lt;title&gt;</span>App Name - @yield('title')<span class="nt">&lt;/title&gt;</span>
    <span class="nt">&lt;/head&gt;</span>
    <span class="nt">&lt;body&gt;</span>
        @section('sidebar')
            This is the master sidebar.
        @show

        <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"container"</span><span class="nt">&gt;</span>
            @yield('content')
        <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</code></pre>
</div>

<h3 id="section-44">使用布局页</h3>

<ul>
  <li><code class="highlighter-rouge">@extends</code>指定布局。</li>
</ul>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="c">&lt;!-- Stored in resources/views/child.blade.php --&gt;</span>

@extends('layouts.master')

@section('title', 'Page Title')

@section('sidebar')
    @parent

    <span class="nt">&lt;p&gt;</span>This is appended to the master sidebar.<span class="nt">&lt;/p&gt;</span>
@endsection

@section('content')
    <span class="nt">&lt;p&gt;</span>This is my body content.<span class="nt">&lt;/p&gt;</span>
@endsection
</code></pre>
</div>

<h3 id="section-45">显示数据</h3>

<div class="highlighter-rouge"><pre class="highlight"><code>//数据绑定：
Route::get('greeting', function () {
    return view('welcome', ['name' =&gt; 'Samantha']);
});

//模板页：
Hello, .
The current UNIX timestamp is .     //可以使用任意PHP代码，会使用htmlentities来防止XSS攻击。
Hello, {!! $name !!}.                           //如果不想使用上述防止XSS攻击的特性
Hello, @.                             //使用@来保持不被Blade引擎处理，比如Javascript中的大括号。
          //带有存在验证的
                        //同上，简写

</code></pre>
</div>

<h3 id="section-46">流程控制</h3>

<div class="highlighter-rouge"><pre class="highlight"><code>//条件判断1
@if (count($records) === 1)
    I have one record!
@elseif (count($records) &gt; 1)
    I have multiple records!
@else
    I don't have any records!
@endif
//条件判断2
@unless (Auth::check())
    You are not signed in.
@endunless
//在布局页面中判断section是否有内容
@hasSection('title')
   @yield('title') - App Name
@else
   App Name
@endif

//循环
@for ($i = 0; $i <span class="nt">&lt; 10</span><span class="err">;</span> <span class="err">$</span><span class="na">i</span><span class="err">++)</span>
    <span class="na">The</span> <span class="na">current</span> <span class="na">value</span> <span class="na">is</span> 
<span class="err">@</span><span class="na">endfor</span>

<span class="err">@</span><span class="na">foreach</span> <span class="err">($</span><span class="na">users</span> <span class="na">as</span> <span class="err">$</span><span class="na">user</span><span class="err">)</span>
    <span class="err">&lt;</span><span class="na">p</span><span class="nt">&gt;</span>This is user <span class="nt">&lt;/p&gt;</span>
@endforeach

@forelse ($users as $user)
    <span class="nt">&lt;li&gt;&lt;/li&gt;</span>
@empty
    <span class="nt">&lt;p&gt;</span>No users<span class="nt">&lt;/p&gt;</span>
@endforelse

@while (true)
    <span class="nt">&lt;p&gt;</span>I'm looping forever.<span class="nt">&lt;/p&gt;</span>
@endwhile

//continue和break
@foreach ($users as $user)
    @if($user-&gt;type == 1)
        @continue
    @endif
    <span class="nt">&lt;li&gt;&lt;/li&gt;</span>
    @if($user-&gt;number == 5)
        @break
    @endif
@endforeach

//continue和break的简写
@foreach ($users as $user)
    @continue($user-&gt;type == 1)
    <span class="nt">&lt;li&gt;&lt;/li&gt;</span>
    @break($user-&gt;number == 5)
@endforeach

//包含子视图，视图参数会继承到其中
<span class="nt">&lt;div&gt;</span>
    @include('shared.errors')
    <span class="nt">&lt;form&gt;</span>
        <span class="c">&lt;!-- Form Contents --&gt;</span>
    <span class="nt">&lt;/form&gt;</span>
<span class="nt">&lt;/div&gt;</span>

//如果还要向其中传入更多参数
@include('view.name', ['some' =&gt; 'data'])

//如果要包含多个子视图，可以简写成：
@each('view.name', $jobs, 'job')            //第一个参数：视图名，第二个参数：想要迭代的数组，第三个参数：迭代变量，还可以有第四个参数：在$jobs为空时的视图名

//注释

</code></pre>
</div>

<h3 id="stacks">Stacks</h3>

<div class="highlighter-rouge"><pre class="highlight"><code>@push('scripts')
    <span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"/example.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
@endpush
//可以多次引用同一个stack：
@stack('scripts')
</code></pre>
</div>

<h3 id="service-injection">Service Injection</h3>

<div class="highlighter-rouge"><pre class="highlight"><code>@inject('metrics', 'App\Services\MetricsService')

<span class="nt">&lt;div&gt;</span>
    Monthly Revenue: .
<span class="nt">&lt;/div&gt;</span>
</code></pre>
</div>

<h3 id="blade-1">扩展Blade</h3>

<ul>
  <li>你可以自己注册指令，如创建一个格式化日期用的<code class="highlighter-rouge">@datetime($var)</code>：</li>
</ul>

<div class="highlighter-rouge"><pre class="highlight"><code>class AppServiceProvider extends ServiceProvider
{
    public function boot()
    {
        Blade::directive('datetime', function($expression) {
            return "<span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nx">with</span><span class="p">{</span><span class="nv">$expression</span><span class="p">}</span><span class="o">-&gt;</span><span class="na">format</span><span class="p">(</span><span class="s1">'m/d/Y H:i'</span><span class="p">);</span> <span class="cp">?&gt;</span>";
        });
    }
    
    public function register(){}
}
</code></pre>
</div>


  </section>
  
</article>


<!--
<div id="disqus_thread"></div>
<script>
/**
* RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
* LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables
*/
/*
var disqus_config = function () {
this.page.url = PAGE_URL; // Replace PAGE_URL with your page's canonical URL variable
this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};
*/
(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');

s.src = '//ifanze.disqus.com/embed.js';

s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
-->
<!--高速版-->
<div id="SOHUCS"></div>
<script charset="utf-8" type="text/javascript" src="http://changyan.sohu.com/upload/changyan.js" ></script>
<script type="text/javascript">
  window.changyan.api.config({
    appid: 'cysp5sdDS',
    conf: 'prod_d82562f88560b08461d2ee27cc031105'
  });
</script>        

      </div>

      <footer class="footer">
  <span class="footer__copyright">Copyright &copy; 2017 孟凡泽. All Rights Reserved. 皖ICP备16011114号-1<br/><br/>Powered by Jekyll. <br/><br/>Theme: Jekyll-Uno by Josh Gerdes</span>
</footer> 

<script type="text/javascript" src="/js/jquery.min.js"></script>
<script type="text/javascript" src="/js/main.js"></script>


    </div>
    <script type="text/javascript" src="http://tajs.qq.com/stats?sId=56525424" charset="UTF-8"></script>
  </body>
</html>
